# 7.1 二重积分理论与计算
 
## 目录

1. [二重积分的定义](#1-二重积分的定义)
2. [二重积分的性质](#2-二重积分的性质)
3. [直角坐标系下的计算](#3-直角坐标系下的计算)
4. [极坐标变换](#4-极坐标变换)
5. [一般坐标变换](#5-一般坐标变换)

---

## 1. 二重积分的定义

### 1.1 二重积分的定义

> **定义1.1（二重积分）**
> 
> 设函数 $f(x, y)$ 在有界闭区域 $D$ 上有界，将 $D$ 任意分割成 $n$ 个小区域 $\Delta D_i$ （面积为 $\Delta A_i$），在每个 $\Delta D_i$ 内任取一点 $(\xi_i, \eta_i)$，作和式：
> $$S_n = \sum_{i=1}^{n} f(\xi_i, \eta_i) \Delta A_i$$
> 
> 如果当各小区域的直径的最大值趋于零时，上述和式的极限存在且与区域的分割方法和点的选取无关，则称此极限为函数 $f(x, y)$ 在区域 $D$ 上的**二重积分**，记作：
> $$\iint_D f(x, y) dA = \lim_{\lambda \to 0} \sum_{i=1}^{n} f(\xi_i, \eta_i) \Delta A_i$$

### 1.2 二重积分的几何意义

当 $f(x, y) \geq 0$ 时，二重积分 $\iint_D f(x, y) dA$ 表示以区域 $D$ 为底，以曲面 $z = f(x, y)$ 为顶的曲顶柱体的体积。

**物理意义**：
- 当 $f(x,y) = 1$ 时，二重积分等于区域 $D$ 的面积
- 当 $f(x,y)$ 表示面密度时，二重积分表示薄片的质量
- 当 $f(x,y)$ 表示压强时，二重积分表示总压力

### 1.3 二重积分的存在性

> **定理1.1（二重积分存在定理）**
> 
> 若函数 $f(x, y)$ 在有界闭区域 $D$ 上连续，则二重积分 $\iint_D f(x, y) dA$ 存在。

**推广**：若 $f(x,y)$ 在区域 $D$ 上除了有限个点或有限条光滑曲线上不连续外，在其余点连续且有界，则二重积分仍然存在。

---

## 2. 二重积分的性质

### 2.1 基本性质

1. **线性性**：
   $$\iint_D [af(x,y) + bg(x,y)] dA = a\iint_D f(x,y) dA + b\iint_D g(x,y) dA$$

2. **区域可加性**：若 $D = D_1 \cup D_2$ 且 $D_1 \cap D_2$ 的面积为零，则：
   $$\iint_D f(x,y) dA = \iint_{D_1} f(x,y) dA + \iint_{D_2} f(x,y) dA$$

3. **保序性**：若在 $D$ 上 $f(x,y) \leq g(x,y)$，则：
   $$\iint_D f(x,y) dA \leq \iint_D g(x,y) dA$$

4. **绝对值不等式**：
   $$\left|\iint_D f(x,y) dA\right| \leq \iint_D |f(x,y)| dA$$

### 2.2 二重积分的估值

> **定理2.1（二重积分估值定理）**
> 
> 设  $m$ 和 $M$ 分别是 $f(x,y)$ 在闭区域 $D$ 上的最小值和最大值， $S$ 是区域 $D$ 的面积，则：
> $$m \cdot S \leq \iint_D f(x,y) dA \leq M \cdot S$$

### 2.3 二重积分中值定理

> **定理2.2（二重积分中值定理）**
> 
> 若 $f(x, y)$ 在有界闭区域 $D$ 上连续，则至少存在一点 $(\xi, \eta) \in D$，使得：
> $$\iint_D f(x, y) dA = f(\xi, \eta) \cdot S$$

**几何意义**：存在某个高度 $f(\xi, \eta)$，使得以此高度为顶的柱体体积等于曲顶柱体的体积。

> **例题2.1**：利用二重积分中值定理估计积分 $\iint_D (x^2 + y^2) dA$ 的值，其中 $D$ 是单位圆 $x^2 + y^2 \leq 1$。

**解答**：
1. **确定函数的最值**：
   - 在区域 $D: x^2 + y^2 \leq 1$ 上
   - $f(x,y) = x^2 + y^2$ 的最小值： $m = 0$ （在原点处）
   - $f(x,y) = x^2 + y^2$ 的最大值： $M = 1$ （在边界 $x^2 + y^2 = 1$ 上）

2. **计算区域面积**：
   $S = \pi \cdot 1^2 = \pi$

3. **应用估值定理**：
   $$0 \cdot \pi \leq \iint_D (x^2 + y^2) dA \leq 1 \cdot \pi$$
   即： $$0 \leq \iint_D (x^2 + y^2) dA \leq \pi$$

4. **应用中值定理**：
   存在点 $(\xi, \eta) \in D$，使得：
   $$\iint_D (x^2 + y^2) dA = (\xi^2 + \eta^2) \cdot \pi$$

5. **精确计算验证**：
   使用极坐标： $\iint_D (x^2 + y^2) dA = \int_0^{2\pi} d\theta \int_0^1 r^2 \cdot r dr = \int_0^{2\pi} d\theta \int_0^1 r^3 dr = 2\pi \cdot \left[\frac{r^4}{4}\right]_0^1 = 2\pi \cdot \frac{1}{4} = \frac{\pi}{2}$
   
   因此 $\xi^2 + \eta^2 = \frac{1}{2}$，即中值点在圆 $x^2 + y^2 = \frac{1}{2}$ 上。

> **例题2.2**：设  $D = \{(x,y) | 0 \leq x \leq 1, 0 \leq y \leq 1\}$，利用中值定理分析积分 $\iint_D \sin(x+y) dA$。

**解答**：
1. **分析函数性质**：
   - 在 $D$ 上， $0 \leq x + y \leq 2$
   - $\sin(x+y)$ 在 $[0, 2]$ 上连续
   - 最小值： $\sin(0) = 0$
   - 最大值： $\sin(2) \approx 0.909$

2. **区域面积**： $S = 1$

3. **中值定理应用**：
   存在 $(\xi, \eta) \in D$，使得：
   $$\iint_D \sin(x+y) dA = \sin(\xi + \eta) \cdot 1 = \sin(\xi + \eta)$$

4. **估值**：
   $$0 \leq \iint_D \sin(x+y) dA \leq \sin(2)$$

**物理意义**：如果 $\sin(x+y)$ 表示某种密度分布，则中值定理告诉我们存在某点的密度值等于平均密度。

---

## 3. 直角坐标系下的计算

### 3.1 X型区域

> **定义3.1（X型区域）**
> 
> 区域 $D = \{(x, y) | a \leq x \leq b, \varphi_1(x) \leq y \leq \varphi_2(x)\}$ 称为X型区域。

**计算公式**：
$$\iint_D f(x, y) dA = \int_a^b dx \int_{\varphi_1(x)}^{\varphi_2(x)} f(x, y) dy$$

### 3.2 Y型区域

> **定义3.2（Y型区域）**
> 
> 区域 $D = \{(x, y) | c \leq y \leq d, \psi_1(y) \leq x \leq \psi_2(y)\}$ 称为Y型区域。

**计算公式**：
$$\iint_D f(x, y) dA = \int_c^d dy \int_{\psi_1(y)}^{\psi_2(y)} f(x, y) dx$$

### 3.3 积分次序的选择

选择积分次序的原则：
1. **被积函数的特点**：选择使得内层积分容易计算的次序
2. **积分区域的形状**：选择使得积分限简单的次序
3. **避免分割区域**：选择不需要分割积分区域的次序

> **例题3.1**：计算 $\iint_D xy dA$，其中 $D$ 是由 $y = x$，$y = x^2$ 围成的区域。

**解答**：

**确定积分区域**：
- 交点： $x = x^2 \Rightarrow x(x-1) = 0 \Rightarrow x = 0, 1$
- 区域： $D = \{(x, y) | 0 \leq x \leq 1, x^2 \leq y \leq x\}$ （X型区域）

**计算积分**：
$$\iint_D xy dA = \int_0^1 x dx \int_{x^2}^x y dy$$
$$= \int_0^1 x \left[\frac{y^2}{2}\right]_{x^2}^x dx = \int_0^1 x \cdot \frac{x^2 - x^4}{2} dx$$
$$= \frac{1}{2} \int_0^1 (x^3 - x^5) dx = \frac{1}{2} \left[\frac{x^4}{4} - \frac{x^6}{6}\right]_0^1$$
$$= \frac{1}{2} \left(\frac{1}{4} - \frac{1}{6}\right) = \frac{1}{2} \cdot \frac{1}{12} = \frac{1}{24}$$

### 3.4 积分次序的选择

选择合适的积分次序可以简化计算：

> **例题3.2**：计算 $\iint_D e^{x^2} dA$，其中 $D = \{(x, y) | 0 \leq x \leq 1, 0 \leq y \leq x\}$。

**解答**：

**方法1**（按 $dydx$ 次序）：
$$\iint_D e^{x^2} dA = \int_0^1 dx \int_0^x e^{x^2} dy = \int_0^1 e^{x^2} \cdot x dx$$

由于 $\int e^{x^2} dx$ 无法用初等函数表示，此路不通。

**方法2**（按 $dxdy$ 次序）：
改写区域： $D = \{(x, y) | 0 \leq y \leq 1, y \leq x \leq 1\}$ （Y型区域）

$$\iint_D e^{x^2} dA = \int_0^1 dy \int_y^1 e^{x^2} dx$$

这仍然困难，但如果被积函数是 $e^{y^2}$，则第二种次序会更好。

---

## 4. 极坐标变换

### 4.1 极坐标变换公式

坐标变换：
$$x = r\cos\theta, \quad y = r\sin\theta$$

**雅可比行列式**：
$$J = \frac{\partial(x, y)}{\partial(r, \theta)} = \begin{vmatrix} \cos\theta & -r\sin\theta \\ \sin\theta & r\cos\theta \end{vmatrix} = r$$

**变换公式**：
$$\iint_D f(x, y) dxdy = \iint_{D'} f(r\cos\theta, r\sin\theta) \cdot r \, drd\theta$$

### 4.2 适用条件

极坐标变换适用于：
1. 积分区域为圆、扇形、环形等
2. 被积函数含有 $x^2 + y^2$、 $\sqrt{x^2 + y^2}$ 等形式

> **例题4.1**：计算 $\iint_D (x^2 + y^2) dA$，其中 $D: x^2 + y^2 \leq 4$。

**解答**：

**极坐标变换**：
- 区域： $D' = \{(r, \theta) | 0 \leq r \leq 2, 0 \leq \theta \leq 2\pi\}$
- 被积函数： $x^2 + y^2 = r^2$

**计算积分**：
$$\iint_D (x^2 + y^2) dA = \int_0^{2\pi} d\theta \int_0^2 r^2 \cdot r dr$$
$$= \int_0^{2\pi} d\theta \int_0^2 r^3 dr = 2\pi \cdot \left[\frac{r^4}{4}\right]_0^2 = 2\pi \cdot 4 = 8\pi$$

> **例题4.2**：计算 $\iint_D e^{-(x^2+y^2)} dA$，其中 $D: x^2 + y^2 \leq 1$。

**解答**：
$$\iint_D e^{-(x^2+y^2)} dA = \int_0^{2\pi} d\theta \int_0^1 e^{-r^2} \cdot r dr$$

令 $t = r^2$，则 $dt = 2r dr$，$r dr = \frac{1}{2} dt$：
$$= \int_0^{2\pi} d\theta \int_0^1 e^{-t} \cdot \frac{1}{2} dt = 2\pi \cdot \frac{1}{2} \left[-e^{-t}\right]_0^1$$
$$= \pi (1 - e^{-1}) = \pi \left(1 - \frac{1}{e}\right)$$

---

## 5. 一般坐标变换

### 5.1 坐标变换的一般公式

设坐标变换：
$$x = x(u, v), \quad y = y(u, v)$$

雅可比行列式：
$$J = \frac{\partial(x, y)}{\partial(u, v)} = \begin{vmatrix} \frac{\partial x}{\partial u} & \frac{\partial x}{\partial v} \\ \frac{\partial y}{\partial u} & \frac{\partial y}{\partial v} \end{vmatrix}$$

**变换公式**：
$$\iint_D f(x, y) dxdy = \iint_{D'} f(x(u,v), y(u,v)) |J| dudv$$

> **例题5.0**：计算坐标变换 $x = u + v, y = u - v$ 的雅可比行列式，并用此变换计算积分 $\iint_D (x + y) dxdy$，其中 $D$ 是由 $x + y = 0, x + y = 2, x - y = 0, x - y = 1$ 围成的区域。

**解答**：
1. **计算雅可比行列式**：
   $$\frac{\partial x}{\partial u} = 1, \quad \frac{\partial x}{\partial v} = 1$$
   $$\frac{\partial y}{\partial u} = 1, \quad \frac{\partial y}{\partial v} = -1$$
   
   $$J = \begin{vmatrix} 1 & 1 \\ 1 & -1 \end{vmatrix} = 1 \cdot (-1) - 1 \cdot 1 = -2$$
   
   因此 $|J| = 2$

2. **确定新的积分区域**：
   - 原区域边界： $x + y = 0, 2$ 和 $x - y = 0, 1$
   - 由于 $x + y = (u + v) + (u - v) = 2u$ 和 $x - y = (u + v) - (u - v) = 2v$
   - 新区域： $D' = \{(u,v) | 0 \leq 2u \leq 2, 0 \leq 2v \leq 1\}$
   - 即： $D' = \{(u,v) | 0 \leq u \leq 1, 0 \leq v \leq \frac{1}{2}\}$

3. **变换被积函数**：
   $x + y = 2u$

4. **计算积分**：
   $$\iint_D (x + y) dxdy = \iint_{D'} 2u \cdot |J| dudv = \iint_{D'} 2u \cdot 2 dudv$$
   $$= 4 \int_0^1 u du \int_0^{1/2} dv = 4 \cdot \frac{1}{2} \cdot \frac{1}{2} = 1$$

### 5.2 常用坐标变换

**椭圆坐标变换**：
$$x = ar\cos\theta, \quad y = br\sin\theta$$
$$J = abr$$

> **例题5.1**：计算椭圆 $\frac{x^2}{a^2} + \frac{y^2}{b^2} \leq 1$ 的面积。

**解答**：
使用椭圆坐标变换，区域变为： $0 \leq r \leq 1, 0 \leq \theta \leq 2\pi$

$$S = \iint_D 1 \, dxdy = \int_0^{2\pi} d\theta \int_0^1 ab \cdot r \, dr$$
$$= ab \int_0^{2\pi} d\theta \int_0^1 r \, dr = ab \cdot 2\pi \cdot \frac{1}{2} = \pi ab$$
 