# 6.3 全微分理论与应用

## 目录

1. [全微分的定义](#1-全微分的定义)
2. [可微性理论](#2-可微性理论)
3. [全微分的计算](#3-全微分的计算)
4. [全微分的应用](#4-全微分的应用)
5. [误差估算理论](#5-误差估算理论)
6. [本章知识点总结](#6-本章知识点总结)

---

## 1. 全微分的定义

### 1.1 全微分的定义

> **定义1.1（全微分）**
> 
> 设函数 $z = f(x,y)$ 在点 $(x_0, y_0)$ 的某个邻域内有定义，如果函数在该点的全增量
> $$\Delta z = f(x_0 + \Delta x, y_0 + \Delta y) - f(x_0, y_0)$$
> 可以表示为
> $$\Delta z = A\Delta x + B\Delta y + o(\rho)$$
> 其中 $A, B$ 是与 $\Delta x, \Delta y$ 无关的常数，$\rho = \sqrt{(\Delta x)^2 + (\Delta y)^2}$，$o(\rho)$ 是当 $\rho \to 0$ 时比 $\rho$ 高阶的无穷小，则称函数 $f(x,y)$ 在点 $(x_0, y_0)$ **可微**，并称 $A\Delta x + B\Delta y$ 为函数在该点的**全微分**，记作：
> $$dz = A\Delta x + B\Delta y = Adx + Bdy$$

**全微分的记号**：
$$dz = \frac{\partial z}{\partial x}dx + \frac{\partial z}{\partial y}dy$$

### 1.2 全微分的几何意义

> **几何意义**：
> 
> 对于曲面 $z = f(x,y)$，全微分 $dz$ 在几何上表示：
> - 当自变量从 $(x_0, y_0)$ 变化到 $(x_0 + dx, y_0 + dy)$ 时
> - 曲面上对应点的切平面上的点的高度变化
> - 全微分是函数真实增量的线性主部

**直观理解**：
- 全微分提供了函数增量的**最佳线性近似**
- 切平面方程： $z = z_0 + f_x(x_0, y_0)(x - x_0) + f_y(x_0, y_0)(y - y_0)$
- 高度变化： $dz = f_x(x_0, y_0)dx + f_y(x_0, y_0)dy$

### 1.3 可微的必要条件

> **定理1.1（可微的必要条件）**
> 
> 如果函数 $z = f(x,y)$ 在点 $(x_0, y_0)$ 可微，则：
> 1. 函数在该点连续
> 2. 函数在该点的偏导数存在，且
>    $$A = \frac{\partial f}{\partial x}(x_0, y_0), \quad B = \frac{\partial f}{\partial y}(x_0, y_0)$$

**证明要点**：
1. **连续性**：从 $\Delta z = A\Delta x + B\Delta y + o(\rho)$ 当 $\rho \to 0$ 时，$\Delta z \to 0$
2. **偏导数存在**：令 $\Delta y = 0$，得到 $\frac{\partial f}{\partial x} = A$

> **例题1.1**：验证函数 $z = x^2 + xy + y^2$ 在点 $(1, 1)$ 处的全微分。

**解答**：
1. **计算偏导数**：
   $$\frac{\partial z}{\partial x} = 2x + y, \quad \frac{\partial z}{\partial y} = x + 2y$$
   
   在点 $(1, 1)$ 处：
   $$\frac{\partial z}{\partial x}\bigg|_{(1,1)} = 3, \quad \frac{\partial z}{\partial y}\bigg|_{(1,1)} = 3$$

2. **全微分**：
   $$dz = 3dx + 3dy$$

3. **验证**：
   $$\Delta z = f(1 + \Delta x, 1 + \Delta y) - f(1, 1)$$
   $$= (1 + \Delta x)^2 + (1 + \Delta x)(1 + \Delta y) + (1 + \Delta y)^2 - 3$$
   $$= 3\Delta x + 3\Delta y + 2(\Delta x)^2 + \Delta x \Delta y + 2(\Delta y)^2$$
   
   其中 $3\Delta x + 3\Delta y$ 是线性主部，其余项是高阶无穷小。

---

## 2. 可微性理论

### 2.1 可微的充分条件

> **定理2.1（可微的充分条件）**
> 
> 如果函数 $z = f(x,y)$ 的偏导数 $\frac{\partial z}{\partial x}$ 和 $\frac{\partial z}{\partial y}$ 在点 $(x_0, y_0)$ 存在且连续，则函数在该点可微。

**重要说明**：
- 这是**充分条件**，不是必要条件
- 偏导数连续 ⇒ 可微 ⇒ 偏导数存在
- 偏导数存在不一定可微

### 2.2 连续、可偏导、可微的关系

```
偏导数连续 ⇒ 可微 ⇒ 偏导数存在
        ⇓        ⇓
      连续    连续
```

**关系总结**：
1. **偏导数连续 ⇒ 可微**（充分条件）
2. **可微 ⇒ 偏导数存在**（必要条件）
3. **可微 ⇒ 连续**（必要条件）
4. **偏导数存在 ⇏ 可微**（不充分）
5. **连续 ⇏ 可微**（不充分）

> **例题2.1**：讨论函数 $f(x,y) = \begin{cases} \frac{x^2y}{x^2 + y^2}, & (x,y) \neq (0,0) \\ 0, & (x,y) = (0,0) \end{cases}$ 在原点的可微性。

**解答**：

1. **偏导数存在性**：
   $$f_x(0,0) = \lim_{h \to 0} \frac{f(h,0) - f(0,0)}{h} = \lim_{h \to 0} \frac{0 - 0}{h} = 0$$
   $$f_y(0,0) = \lim_{h \to 0} \frac{f(0,h) - f(0,0)}{h} = \lim_{h \to 0} \frac{0 - 0}{h} = 0$$

2. **可微性检验**：
   需要验证 $\lim_{\rho \to 0} \frac{\Delta f - f_x(0,0)\Delta x - f_y(0,0)\Delta y}{\rho} = 0$
   
   即： $\lim_{\rho \to 0} \frac{f(\Delta x, \Delta y)}{\sqrt{(\Delta x)^2 + (\Delta y)^2}} = \lim_{\rho \to 0} \frac{(\Delta x)^2 \Delta y}{[(\Delta x)^2 + (\Delta y)^2]^{3/2}}$
   
   设  $\Delta x = \rho \cos \theta$， $\Delta y = \rho \sin \theta$：
   $$\lim_{\rho \to 0} \frac{\rho^3 \cos^2 \theta \sin \theta}{\rho^3} = \cos^2 \theta \sin \theta$$
   
   这个极限依赖于 $\theta$，不存在，所以函数在原点不可微。

**结论**：偏导数存在但不可微的例子。

### 2.3 可微性的判定方法

**标准方法**：
1. **计算偏导数**：求出 $f_x(x_0, y_0)$ 和 $f_y(x_0, y_0)$
2. **计算极限**：验证 $\lim_{\rho \to 0} \frac{\Delta f - f_x \Delta x - f_y \Delta y}{\rho} = 0$
3. **简化判定**：如果偏导数在该点连续，则可微

---

## 3. 全微分的计算

### 3.1 基本函数的全微分

**计算公式**：
$$dz = \frac{\partial z}{\partial x}dx + \frac{\partial z}{\partial y}dy$$

> **例题3.1**：求下列函数的全微分：
> 
> (1) $z = x^3 + y^3 + 3xy$
> (2) $z = e^{xy}$
> (3) $z = \ln(x^2 + y^2)$
> (4) $z = \sin(xy)$

**解答**：

(1) $z = x^3 + y^3 + 3xy$
   $$\frac{\partial z}{\partial x} = 3x^2 + 3y, \quad \frac{\partial z}{\partial y} = 3y^2 + 3x$$
   $$dz = (3x^2 + 3y)dx + (3y^2 + 3x)dy$$

(2) $z = e^{xy}$
   $$\frac{\partial z}{\partial x} = ye^{xy}, \quad \frac{\partial z}{\partial y} = xe^{xy}$$
   $$dz = ye^{xy}dx + xe^{xy}dy = e^{xy}(y dx + x dy)$$

(3) $z = \ln(x^2 + y^2)$
   $$\frac{\partial z}{\partial x} = \frac{2x}{x^2 + y^2}, \quad \frac{\partial z}{\partial y} = \frac{2y}{x^2 + y^2}$$
   $$dz = \frac{2x}{x^2 + y^2}dx + \frac{2y}{x^2 + y^2}dy = \frac{2(x dx + y dy)}{x^2 + y^2}$$

(4) $z = \sin(xy)$
   $$\frac{\partial z}{\partial x} = y\cos(xy), \quad \frac{\partial z}{\partial y} = x\cos(xy)$$
   $$dz = y\cos(xy)dx + x\cos(xy)dy = \cos(xy)(y dx + x dy)$$

### 3.2 复合函数的全微分

对于复合函数，可以使用链式法则或全微分的形式不变性。

> **定理3.1（全微分形式的不变性）**
> 
> 无论 $x, y$ 是自变量还是中间变量，全微分的形式
> $$dz = \frac{\partial z}{\partial x}dx + \frac{\partial z}{\partial y}dy$$
> 都保持不变。

> **例题3.2**：设  $z = f(u, v)$，其中 $u = x^2 + y^2$， $v = xy$，且 $f$ 具有连续偏导数，求 $dz$。

**解答**：
使用全微分的形式不变性：
$$dz = \frac{\partial f}{\partial u}du + \frac{\partial f}{\partial v}dv$$

其中：
$$du = d(x^2 + y^2) = 2x dx + 2y dy$$
$$dv = d(xy) = y dx + x dy$$

所以：
$$dz = f_u(2x dx + 2y dy) + f_v(y dx + x dy)$$
$$= (2xf_u + yf_v)dx + (2yf_u + xf_v)dy$$

### 3.3 隐函数的全微分

> **例题3.3**：设  $F(x, y, z) = x^2 + y^2 + z^2 - 1 = 0$ 确定隐函数 $z = z(x, y)$，求 $dz$。

**解答**：
对 $F(x, y, z) = 0$ 求全微分：
$$dF = F_x dx + F_y dy + F_z dz = 0$$
$$2x dx + 2y dy + 2z dz = 0$$

解得：
$$dz = -\frac{x}{z}dx - \frac{y}{z}dy$$

### 3.4 三元函数的全微分

对于三元函数 $u = f(x, y, z)$：
$$du = \frac{\partial u}{\partial x}dx + \frac{\partial u}{\partial y}dy + \frac{\partial u}{\partial z}dz$$

> **例题3.4**：求函数 $u = xyz$ 的全微分。

**解答**：
$$\frac{\partial u}{\partial x} = yz, \quad \frac{\partial u}{\partial y} = xz, \quad \frac{\partial u}{\partial z} = xy$$

$$du = yz dx + xz dy + xy dz$$

---

## 4. 全微分的应用

### 4.1 近似计算

当 $|\Delta x|$ 和 $|\Delta y|$ 都很小时，有近似公式：
$$\Delta z \approx dz = f_x(x_0, y_0)\Delta x + f_y(x_0, y_0)\Delta y$$

> **例题4.1**：计算 $(1.02)^{2.97}$ 的近似值。

**解答**：
设  $f(x, y) = x^y$，在点 $(1, 3)$ 附近计算 $f(1.02, 2.97)$。

1. **计算偏导数**：
   $$\frac{\partial f}{\partial x} = yx^{y-1}, \quad \frac{\partial f}{\partial y} = x^y \ln x$$
   
   在点 $(1, 3)$ 处：
   $$f_x(1, 3) = 3 \cdot 1^2 = 3$$
   $$f_y(1, 3) = 1^3 \ln 1 = 0$$

2. **近似计算**：
   $$f(1.02, 2.97) \approx f(1, 3) + f_x(1, 3) \cdot 0.02 + f_y(1, 3) \cdot (-0.03)$$
   $$= 1 + 3 \times 0.02 + 0 \times (-0.03) = 1.06$$

### 4.2 函数值的增量估算

> **例题4.2**：已知圆锥体的高 $h = 10$ cm，底半径 $r = 3$ cm，如果测量时高的误差不超过 $0.1$ cm，半径的误差不超过 $0.05$ cm，求体积的最大绝对误差。

**解答**：
圆锥体积公式： $V = \frac{1}{3}\pi r^2 h$

1. **计算偏导数**：
   $$\frac{\partial V}{\partial r} = \frac{2\pi r h}{3}, \quad \frac{\partial V}{\partial h} = \frac{\pi r^2}{3}$$
   
   在 $(r, h) = (3, 10)$ 处：
   $$\frac{\partial V}{\partial r} = \frac{2\pi \cdot 3 \cdot 10}{3} = 20\pi$$
   $$\frac{\partial V}{\partial h} = \frac{\pi \cdot 9}{3} = 3\pi$$

2. **误差估算**：
   $$|dV| = \left|\frac{\partial V}{\partial r}dr + \frac{\partial V}{\partial h}dh\right|$$
   $$\leq \left|\frac{\partial V}{\partial r}\right||dr| + \left|\frac{\partial V}{\partial h}\right||dh|$$
   $$\leq 20\pi \times 0.05 + 3\pi \times 0.1 = \pi + 0.3\pi = 1.3\pi$$

**结论**：体积的最大绝对误差约为 $1.3\pi \approx 4.08$ cm³。

### 4.3 相对误差与相对变化率

> **定义4.1（相对误差）**
> 
> 函数 $z = f(x, y)$ 的相对误差为：
> $$\frac{dz}{z} = \frac{f_x dx + f_y dy}{f(x, y)}$$

> **例题4.3**：对于函数 $z = x^a y^b$，求相对误差公式。

**解答**：
$$\frac{\partial z}{\partial x} = ax^{a-1}y^b, \quad \frac{\partial z}{\partial y} = bx^a y^{b-1}$$

$$\frac{dz}{z} = \frac{ax^{a-1}y^b dx + bx^a y^{b-1} dy}{x^a y^b} = a\frac{dx}{x} + b\frac{dy}{y}$$

**结论**：对于幂函数 $z = x^a y^b$，相对误差等于各变量相对误差的加权和。

---

## 5. 误差估算理论

### 5.1 绝对误差与相对误差

**绝对误差**： $|\Delta z| \approx |dz|$

**相对误差**： $\left|\frac{\Delta z}{z}\right| \approx \left|\frac{dz}{z}\right|$

### 5.2 误差传播公式

对于函数 $z = f(x_1, x_2, \ldots, x_n)$：

**绝对误差**：
$$|dz| \leq \sum_{i=1}^n \left|\frac{\partial z}{\partial x_i}\right| |dx_i|$$

**相对误差**：
$$\left|\frac{dz}{z}\right| \leq \sum_{i=1}^n \left|\frac{\partial z}{\partial x_i} \cdot \frac{x_i}{z}\right| \left|\frac{dx_i}{x_i}\right|$$

### 5.3 常用函数的误差公式

| 函数形式 | 绝对误差 | 相对误差 |
|:---------|:---------|:---------|
| $z = x + y$ | $\|dx\| + \|dy\|$ | $\frac{\|x\|\|dx/x\| + \|y\|\|dy/y\|}{\|x + y\|}$ |
| $z = xy$ | $\|y\|\|dx\| + \|x\|\|dy\|$ | $\|dx/x\| + \|dy/y\|$ |
| $z = x/y$ | $\frac{\|dx\| + \|x\|\|dy/y\|}{\|y\|}$ | $\|dx/x\| + \|dy/y\|$ |
| $z = x^n$ | $\|nx^{n-1}\|\|dx\|$ | $\|n\|\|dx/x\|$ |

> **例题5.1**：用全微分方法估算 $\sqrt{(3.02)^2 + (3.97)^2}$ 的值和误差。

**解答**：
设  $f(x, y) = \sqrt{x^2 + y^2}$，在点 $(3, 4)$ 附近计算。

1. **精确值**： $f(3, 4) = \sqrt{9 + 16} = 5$

2. **偏导数**：
   $$f_x = \frac{x}{\sqrt{x^2 + y^2}}, \quad f_y = \frac{y}{\sqrt{x^2 + y^2}}$$
   
   在点 $(3, 4)$ 处：
   $$f_x(3, 4) = \frac{3}{5}, \quad f_y(3, 4) = \frac{4}{5}$$

3. **近似值**：
   $$f(3.02, 3.97) \approx 5 + \frac{3}{5} \times 0.02 + \frac{4}{5} \times (-0.03)$$
   $$= 5 + 0.012 - 0.024 = 4.988$$

4. **误差估算**：
   $$|df| \leq \frac{3}{5} \times 0.02 + \frac{4}{5} \times 0.03 = 0.012 + 0.024 = 0.036$$

**结论**： $\sqrt{(3.02)^2 + (3.97)^2} \approx 4.988 \pm 0.036$

